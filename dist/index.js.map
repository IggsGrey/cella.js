{"version":3,"file":"index.js","mappings":"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","sources":["webpack://Cella/webpack/universalModuleDefinition","webpack://Cella/./src/cella.ts","webpack://Cella/./src/encryption/encrypt.ts","webpack://Cella/./src/exceptions/exceptions.ts","webpack://Cella/./src/index.ts","webpack://Cella/./src/storage/indexedDB.ts","webpack://Cella/./src/storage/localStorage.ts","webpack://Cella/./src/storage/storage.ts","webpack://Cella/external umd {\"commonjs\":\"crypto-js\",\"commonjs2\":\"crypto-js\",\"amd\":\"crypto-js\",\"root\":\"CryptoJS\"}","webpack://Cella/webpack/bootstrap","webpack://Cella/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"crypto-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"crypto-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Cella\"] = factory(require(\"crypto-js\"));\n\telse\n\t\troot[\"Cella\"] = factory(root[\"CryptoJS\"]);\n})(self, (__WEBPACK_EXTERNAL_MODULE__615__) => {\nreturn ","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar encrypt_1 = require(\"./encryption/encrypt\");\nvar exceptions_1 = __importDefault(require(\"./exceptions/exceptions\"));\nvar storage_1 = __importDefault(require(\"./storage/storage\"));\nvar Cella = /** @class */ (function () {\n    function Cella(props) {\n        var _this = this;\n        var _a, _b;\n        this.transforms = [];\n        this.defaultStorage = storage_1.default.localStorage;\n        this.execStore = function (_a) {\n            var key = _a.key, value = _a.value;\n            if (!key || !key.length)\n                throw exceptions_1.default.nullKey;\n            // if(localStorage.getItem(key)) throw exceptions.keyExists\n            // execute inbound transforms if any\n            if (_this.transforms.length) {\n                _this.transforms.forEach(function (t) {\n                    value = t.inbound(value);\n                });\n            }\n            // ensure value is most defnitely a string\n            if (!value)\n                value = '';\n            else\n                value = JSON.stringify(value);\n            // apply encryption if any\n            if (_this.encrypt) {\n                if (!_this.encrypt.secret || !_this.encrypt.secret.length)\n                    throw exceptions_1.default.nullSecretKey;\n                value = (0, encrypt_1.applyEncrypt)(value, _this.encrypt.secret);\n            }\n            _this.storage.store(key, value);\n        };\n        this.execGet = function (_a) {\n            var _b;\n            var key = _a.key;\n            if (!key || !key.length)\n                throw exceptions_1.default.nullKey;\n            var value = (_b = _this.storage.get(key)) !== null && _b !== void 0 ? _b : '';\n            // apply decryption if any\n            if (_this.encrypt) {\n                if (!_this.encrypt.secret || !_this.encrypt.secret.length)\n                    throw exceptions_1.default.nullSecretKey;\n                value = (0, encrypt_1.applyDecrypt)(value, _this.encrypt.secret);\n            }\n            // parse json\n            if (value.length) {\n                try {\n                    value = JSON.parse(value);\n                }\n                catch (_c) {\n                    // parsing from json will fail if\n                    // retrieved value is an 8byte (is that what crypto-js said?) encrypted item\n                    throw exceptions_1.default.retrievingUndecryptedItem;\n                }\n            }\n            // execute outbound transforms if any\n            if (_this.transforms.length) {\n                _this.transforms.forEach(function (t) {\n                    value = t.outbound(value);\n                });\n            }\n            return value;\n        };\n        this.execEject = function (_a) {\n            var key = _a.key;\n            if (!key || !key.length)\n                throw exceptions_1.default.nullKey;\n            _this.storage.eject(key);\n        };\n        this.store = function (_a) {\n            var key = _a.key, value = _a.value;\n            return Promise.resolve(_this.execStore({ key: key, value: value }));\n        };\n        this.get = function (param) {\n            if (typeof param == 'object') {\n                return Promise.resolve(_this.execGet({ key: param === null || param === void 0 ? void 0 : param.key }));\n            }\n            else if (typeof param == 'string') {\n                return Promise.resolve(_this.execGet({ key: param }));\n            }\n            else {\n                return Promise.reject();\n            }\n        };\n        this.eject = function (param) {\n            if (typeof param == 'object') {\n                return Promise.resolve(_this.execEject({ key: param === null || param === void 0 ? void 0 : param.key }));\n            }\n            else if (typeof param == 'string') {\n                return Promise.resolve(_this.execEject({ key: param }));\n            }\n            else {\n                return Promise.reject();\n            }\n            // return (new Promise((resolve, reject) => {\n            // \tresolve(this.execEject({ key }));\n            // })) as Promise<void>;\n        };\n        // determine storage engine\n        if (props === null || props === void 0 ? void 0 : props.storage) {\n            // type check probably not required.\n            if (typeof (props === null || props === void 0 ? void 0 : props.storage) == 'object' && 'type' in (props === null || props === void 0 ? void 0 : props.storage)) {\n                var selectedEngine = props.storage;\n                if (selectedEngine.type == 'indexedDB') {\n                    this.storage = storage_1.default[selectedEngine.type](selectedEngine.name);\n                }\n                else {\n                    this.storage = storage_1.default[selectedEngine.type];\n                }\n            }\n            this.storage = (_a = props === null || props === void 0 ? void 0 : props.storage) !== null && _a !== void 0 ? _a : this.defaultStorage;\n        }\n        else {\n            this.storage = this.defaultStorage;\n        }\n        // assign modifier functions (transforms) if any\n        if ((_b = props === null || props === void 0 ? void 0 : props.transforms) === null || _b === void 0 ? void 0 : _b.length) {\n            this.transforms = props === null || props === void 0 ? void 0 : props.transforms;\n        }\n        // bind encrypt\n        this.encrypt = props === null || props === void 0 ? void 0 : props.encrypt;\n    }\n    return Cella;\n}());\nexports.default = Cella;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.applyDecrypt = exports.applyEncrypt = void 0;\nvar crypto_js_1 = __importDefault(require(\"crypto-js\"));\n// Encrypt\nvar applyEncrypt = function (text, secret) {\n    return crypto_js_1.default.AES.encrypt(text, secret).toString();\n};\nexports.applyEncrypt = applyEncrypt;\n// Decrypt\nvar applyDecrypt = function (cipherText, secret) {\n    var bytes = crypto_js_1.default.AES.decrypt(cipherText, secret);\n    return bytes.toString(crypto_js_1.default.enc.Utf8);\n};\nexports.applyDecrypt = applyDecrypt;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar exceptions = {\n    nullSecretKey: 'NO SECRET KEY DEFINED. YOU NEED TO DEFINED A SECRET KEY IN ORDER TO SUCCESSFULLY ENCRYPT OR DECRYPT DATA.',\n    nullKey: 'NO STORAGE ITEM KEY DEFINED. UNABLE TO IDENTIFY STORAGE ITEM TO RETRIEVE',\n    retrievingUndecryptedItem: 'TRYING TO RETRIEVE ENCRYPTED ITEM WITH INVALD OR UNSPECIFIED DECRYPTION CODE',\n    indexedDB: {\n        unsupported: 'THIS BROWSER DOES NOT YET SUPPORT THE INDEXEDDB SPECIFICATION OR IT IS IMPROPERLY SPECIFED'\n    }\n};\nexports.default = exceptions;\n","\"use strict\";\n/* eslint-disable @typescript-eslint/no-var-requires */\nvar Cella = require('./cella').default;\nmodule.exports = Cella;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar customIndexedDB = function (name) {\n    return {\n        store: function (key, value) { return localStorage.setItem(key, value); },\n        get: function (key) { return localStorage.getItem(key); },\n        eject: function (key) { return localStorage.removeItem(key); }\n    };\n};\nexports.default = customIndexedDB;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar customLocalStorage = {\n    store: function (key, value) { return localStorage.setItem(key, value); },\n    get: function (key) { return localStorage.getItem(key); },\n    eject: function (key) { return localStorage.removeItem(key); }\n};\nexports.default = customLocalStorage;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar indexedDB_1 = __importDefault(require(\"./indexedDB\"));\nvar localStorage_1 = __importDefault(require(\"./localStorage\"));\nvar storage = {\n    localStorage: localStorage_1.default,\n    indexedDB: function (name) { return (0, indexedDB_1.default)(name); }\n};\nexports.default = storage;\n","module.exports = __WEBPACK_EXTERNAL_MODULE__615__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__615__","__importDefault","this","mod","__esModule","Object","defineProperty","value","encrypt_1","exceptions_1","storage_1","props","_a","_b","_this","transforms","defaultStorage","default","localStorage","execStore","key","length","nullKey","forEach","t","inbound","JSON","stringify","encrypt","secret","nullSecretKey","applyEncrypt","storage","store","execGet","get","applyDecrypt","parse","_c","retrievingUndecryptedItem","outbound","execEject","eject","Promise","resolve","param","reject","selectedEngine","type","name","crypto_js_1","text","AES","toString","cipherText","decrypt","enc","Utf8","indexedDB","unsupported","Cella","setItem","getItem","removeItem","customLocalStorage","indexedDB_1","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call"],"sourceRoot":""}
{"version":3,"sources":["webpack://Cella/webpack/universalModuleDefinition","webpack://Cella/./src/cella.ts","webpack://Cella/./src/encryption/encrypt.ts","webpack://Cella/./src/exceptions/exceptions.ts","webpack://Cella/./src/index.ts","webpack://Cella/./src/storage/indexedDB.ts","webpack://Cella/./src/storage/localStorage.ts","webpack://Cella/./src/storage/storage.ts","webpack://Cella/external {\"commonjs\":\"crypto-js\",\"commonjs2\":\"crypto-js\",\"amd\":\"crypto-js\",\"root\":\"CryptoJS\"}","webpack://Cella/webpack/bootstrap","webpack://Cella/webpack/startup"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;;;;;;;;;;ACVa;AACb;AACA,4CAA4C;AAC5C;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,gBAAgB,mBAAO,CAAC,yDAAsB;AAC9C,mCAAmC,mBAAO,CAAC,+DAAyB;AACpE,gCAAgC,mBAAO,CAAC,mDAAmB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,yBAAyB;AAC7E;AACA;AACA;AACA,sDAAsD,+DAA+D;AACrH;AACA;AACA,sDAAsD,aAAa;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,+DAA+D;AACvH;AACA;AACA,wDAAwD,aAAa;AACrE;AACA;AACA;AACA;AACA;AACA,wCAAwC,MAAM;AAC9C,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,eAAe;;;;;;;;;;;AClIF;AACb;AACA,4CAA4C;AAC5C;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,oBAAoB,GAAG,oBAAoB;AAC3C,kCAAkC,mBAAO,CAAC,4BAAW;AACrD;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,oBAAoB;;;;;;;;;;;ACjBP;AACb,8CAA6C,CAAC,cAAc,EAAC;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;;;;;;;;;;;ACVF;AACb;AACA,YAAY,4DAA0B;AACtC;;;;;;;;;;;ACHa;AACb,8CAA6C,CAAC,cAAc,EAAC;AAC7D;AACA;AACA,sCAAsC,yCAAyC,EAAE;AACjF,6BAA6B,kCAAkC,EAAE;AACjE,+BAA+B,qCAAqC;AACpE;AACA;AACA,eAAe;;;;;;;;;;;ACTF;AACb,8CAA6C,CAAC,cAAc,EAAC;AAC7D;AACA,kCAAkC,yCAAyC,EAAE;AAC7E,yBAAyB,kCAAkC,EAAE;AAC7D,2BAA2B,qCAAqC;AAChE;AACA,eAAe;;;;;;;;;;;ACPF;AACb;AACA,4CAA4C;AAC5C;AACA,8CAA6C,CAAC,cAAc,EAAC;AAC7D,kCAAkC,mBAAO,CAAC,+CAAa;AACvD,qCAAqC,mBAAO,CAAC,qDAAgB;AAC7D;AACA;AACA,gCAAgC,kCAAkC;AAClE;AACA,eAAe;;;;;;;;;;;ACXf,uD;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;UCrBA;UACA;UACA;UACA","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"crypto-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"crypto-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Cella\"] = factory(require(\"crypto-js\"));\n\telse\n\t\troot[\"Cella\"] = factory(root[\"CryptoJS\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE_crypto_js__) {\nreturn ","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar encrypt_1 = require(\"./encryption/encrypt\");\r\nvar exceptions_1 = __importDefault(require(\"./exceptions/exceptions\"));\r\nvar storage_1 = __importDefault(require(\"./storage/storage\"));\r\nvar Cella = /** @class */ (function () {\r\n    function Cella(props) {\r\n        var _this = this;\r\n        var _a, _b;\r\n        this.transforms = [];\r\n        this.defaultStorage = storage_1.default.localStorage;\r\n        this.execStore = function (_a) {\r\n            var key = _a.key, value = _a.value;\r\n            if (!key || !key.length)\r\n                throw exceptions_1.default.nullKey;\r\n            // if(localStorage.getItem(key)) throw exceptions.keyExists\r\n            // execute inbound transforms if any\r\n            if (_this.transforms.length) {\r\n                _this.transforms.forEach(function (t) {\r\n                    value = t.inbound(value);\r\n                });\r\n            }\r\n            // ensure value is most defnitely a string\r\n            if (!value)\r\n                value = '';\r\n            else\r\n                value = JSON.stringify(value);\r\n            // apply encryption if any\r\n            if (_this.encrypt) {\r\n                if (!_this.encrypt.secret || !_this.encrypt.secret.length)\r\n                    throw exceptions_1.default.nullSecretKey;\r\n                value = encrypt_1.applyEncrypt(value, _this.encrypt.secret);\r\n            }\r\n            _this.storage.store(key, value);\r\n        };\r\n        this.execGet = function (_a) {\r\n            var _b;\r\n            var key = _a.key;\r\n            if (!key || !key.length)\r\n                throw exceptions_1.default.nullKey;\r\n            var value = (_b = _this.storage.get(key)) !== null && _b !== void 0 ? _b : '';\r\n            // apply decryption if any\r\n            if (_this.encrypt) {\r\n                if (!_this.encrypt.secret || !_this.encrypt.secret.length)\r\n                    throw exceptions_1.default.nullSecretKey;\r\n                value = encrypt_1.applyDecrypt(value, _this.encrypt.secret);\r\n            }\r\n            // parse json\r\n            if (value.length) {\r\n                try {\r\n                    value = JSON.parse(value);\r\n                }\r\n                catch (_c) {\r\n                    // parsing from json will fail if\r\n                    // retrieved value is an 8byte (is that what crypto-js said?) encrypted item\r\n                    throw exceptions_1.default.retrievingUndecryptedItem;\r\n                }\r\n            }\r\n            // execute outbound transforms if any\r\n            if (_this.transforms.length) {\r\n                _this.transforms.forEach(function (t) {\r\n                    value = t.outbound(value);\r\n                });\r\n            }\r\n            return value;\r\n        };\r\n        this.execEject = function (_a) {\r\n            var key = _a.key;\r\n            if (!key || !key.length)\r\n                throw exceptions_1.default.nullKey;\r\n            _this.storage.eject(key);\r\n        };\r\n        this.store = function (_a) {\r\n            var key = _a.key, value = _a.value;\r\n            return Promise.resolve(_this.execStore({ key: key, value: value }));\r\n        };\r\n        this.get = function (param) {\r\n            if (typeof param == 'object') {\r\n                return Promise.resolve(_this.execGet({ key: param === null || param === void 0 ? void 0 : param.key }));\r\n            }\r\n            else if (typeof param == 'string') {\r\n                return Promise.resolve(_this.execGet({ key: param }));\r\n            }\r\n            else {\r\n                return Promise.reject();\r\n            }\r\n        };\r\n        this.eject = function (param) {\r\n            if (typeof param == 'object') {\r\n                return Promise.resolve(_this.execEject({ key: param === null || param === void 0 ? void 0 : param.key }));\r\n            }\r\n            else if (typeof param == 'string') {\r\n                return Promise.resolve(_this.execEject({ key: param }));\r\n            }\r\n            else {\r\n                return Promise.reject();\r\n            }\r\n            // return (new Promise((resolve, reject) => {\r\n            // \tresolve(this.execEject({ key }));\r\n            // })) as Promise<void>;\r\n        };\r\n        // determine storage engine\r\n        if (props === null || props === void 0 ? void 0 : props.storage) {\r\n            // type check probably not required.\r\n            if (typeof (props === null || props === void 0 ? void 0 : props.storage) == 'object' && 'type' in (props === null || props === void 0 ? void 0 : props.storage)) {\r\n                var selectedEngine = props.storage;\r\n                if (selectedEngine.type == 'indexedDB') {\r\n                    this.storage = storage_1.default[selectedEngine.type](selectedEngine.name);\r\n                }\r\n                else {\r\n                    this.storage = storage_1.default[selectedEngine.type];\r\n                }\r\n            }\r\n            this.storage = (_a = props === null || props === void 0 ? void 0 : props.storage) !== null && _a !== void 0 ? _a : this.defaultStorage;\r\n        }\r\n        else {\r\n            this.storage = this.defaultStorage;\r\n        }\r\n        // assign modifier functions (transforms) if any\r\n        if ((_b = props === null || props === void 0 ? void 0 : props.transforms) === null || _b === void 0 ? void 0 : _b.length) {\r\n            this.transforms = props === null || props === void 0 ? void 0 : props.transforms;\r\n        }\r\n        // bind encrypt\r\n        this.encrypt = props === null || props === void 0 ? void 0 : props.encrypt;\r\n    }\r\n    return Cella;\r\n}());\r\nexports.default = Cella;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.applyDecrypt = exports.applyEncrypt = void 0;\r\nvar crypto_js_1 = __importDefault(require(\"crypto-js\"));\r\n// Encrypt\r\nvar applyEncrypt = function (text, secret) {\r\n    return crypto_js_1.default.AES.encrypt(text, secret).toString();\r\n};\r\nexports.applyEncrypt = applyEncrypt;\r\n// Decrypt\r\nvar applyDecrypt = function (cipherText, secret) {\r\n    var bytes = crypto_js_1.default.AES.decrypt(cipherText, secret);\r\n    return bytes.toString(crypto_js_1.default.enc.Utf8);\r\n};\r\nexports.applyDecrypt = applyDecrypt;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar exceptions = {\r\n    nullSecretKey: 'NO SECRET KEY DEFINED. YOU NEED TO DEFINED A SECRET KEY IN ORDER TO SUCCESSFULLY ENCRYPT OR DECRYPT DATA.',\r\n    nullKey: 'NO STORAGE ITEM KEY DEFINED. UNABLE TO IDENTIFY STORAGE ITEM TO RETRIEVE',\r\n    retrievingUndecryptedItem: 'TRYING TO RETRIEVE ENCRYPTED ITEM WITH INVALD OR UNSPECIFIED DECRYPTION CODE',\r\n    indexedDB: {\r\n        unsupported: 'THIS BROWSER DOES NOT YET SUPPORT THE INDEXEDDB SPECIFICATION OR IT IS IMPROPERLY SPECIFED'\r\n    }\r\n};\r\nexports.default = exceptions;\r\n","\"use strict\";\r\n/* eslint-disable @typescript-eslint/no-var-requires */\r\nvar Cella = require('./cella').default;\r\nmodule.exports = Cella;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar customIndexedDB = function (name) {\r\n    return {\r\n        store: function (key, value) { return localStorage.setItem(key, value); },\r\n        get: function (key) { return localStorage.getItem(key); },\r\n        eject: function (key) { return localStorage.removeItem(key); }\r\n    };\r\n};\r\nexports.default = customIndexedDB;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar customLocalStorage = {\r\n    store: function (key, value) { return localStorage.setItem(key, value); },\r\n    get: function (key) { return localStorage.getItem(key); },\r\n    eject: function (key) { return localStorage.removeItem(key); }\r\n};\r\nexports.default = customLocalStorage;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar indexedDB_1 = __importDefault(require(\"./indexedDB\"));\r\nvar localStorage_1 = __importDefault(require(\"./localStorage\"));\r\nvar storage = {\r\n    localStorage: localStorage_1.default,\r\n    indexedDB: function (name) { return indexedDB_1.default(name); }\r\n};\r\nexports.default = storage;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE_crypto_js__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(\"./src/index.ts\");\n"],"sourceRoot":""}
{"version":3,"sources":["webpack://Cella/webpack/universalModuleDefinition","webpack://Cella/./src/encrypt.ts","webpack://Cella/./src/exceptions.ts","webpack://Cella/./src/index.ts","webpack://Cella/./src/storage/indexedDB.ts","webpack://Cella/./src/storage/localStorage.ts","webpack://Cella/./src/storage/storage.ts","webpack://Cella/external {\"commonjs\":\"crypto-js\",\"commonjs2\":\"crypto-js\",\"amd\":\"crypto-js\",\"root\":\"CryptoJS\"}","webpack://Cella/webpack/bootstrap","webpack://Cella/webpack/startup"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__226__","__importDefault","this","mod","__esModule","Object","defineProperty","value","applyDecrypt","applyEncrypt","crypto_js_1","text","secret","default","AES","encrypt","toString","cipherText","decrypt","enc","Utf8","nullSecretKey","nullKey","retrievingUndecryptedItem","indexedDB","unsupported","encrypt_1","exceptions_1","storage_1","props","_a","_b","_this","transforms","defaultStorage","localStorage","store","key","length","forEach","t","inbound","JSON","stringify","storage","get","parse","_c","outbound","eject","selectedEngine","type","name","setItem","getItem","removeItem","customLocalStorage","indexedDB_1","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","call"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"crypto-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"crypto-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Cella\"] = factory(require(\"crypto-js\"));\n\telse\n\t\troot[\"Cella\"] = factory(root[\"CryptoJS\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__226__) {\nreturn ","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.applyDecrypt = exports.applyEncrypt = void 0;\r\nvar crypto_js_1 = __importDefault(require(\"crypto-js\"));\r\n// Encrypt\r\nvar applyEncrypt = function (text, secret) {\r\n    return crypto_js_1.default.AES.encrypt(text, secret).toString();\r\n};\r\nexports.applyEncrypt = applyEncrypt;\r\n// Decrypt\r\nvar applyDecrypt = function (cipherText, secret) {\r\n    var bytes = crypto_js_1.default.AES.decrypt(cipherText, secret);\r\n    return bytes.toString(crypto_js_1.default.enc.Utf8);\r\n};\r\nexports.applyDecrypt = applyDecrypt;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar exceptions = {\r\n    nullSecretKey: 'NO SECRET KEY DEFINED. YOU NEED TO DEFINED A SECRET KEY IN ORDER TO SUCCESSFULLY ENCRYPT OR DECRYPT DATA.',\r\n    nullKey: 'NO STORAGE ITEM KEY DEFINED. UNABLE TO IDENTIFY STORAGE ITEM TO RETRIEVE',\r\n    retrievingUndecryptedItem: 'TRYING TO RETRIEVE ENCRYPTED ITEM WITH INVALD OR UNSPECIFIED DECRYPTION CODE',\r\n    indexedDB: {\r\n        unsupported: 'THIS BROWSER DOES NOT YET SUPPORT THE INDEXEDDB SPECIFICATION OR IT IS IMPROPERLY SPECIFED'\r\n    }\r\n};\r\nexports.default = exceptions;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar encrypt_1 = require(\"./encrypt\");\r\nvar exceptions_1 = __importDefault(require(\"./exceptions\"));\r\nvar storage_1 = __importDefault(require(\"./storage/storage\"));\r\nvar Cella = /** @class */ (function () {\r\n    function Cella(props) {\r\n        var _this = this;\r\n        var _a, _b;\r\n        this.transforms = [];\r\n        this.defaultStorage = storage_1.default.localStorage;\r\n        this.store = function (_a) {\r\n            var key = _a.key, value = _a.value;\r\n            if (!key || !key.length)\r\n                throw exceptions_1.default.nullKey;\r\n            // if(localStorage.getItem(key)) throw exceptions.keyExists\r\n            // execute inbound transforms if any\r\n            if (_this.transforms.length) {\r\n                _this.transforms.forEach(function (t) {\r\n                    value = t.inbound(value);\r\n                });\r\n            }\r\n            // ensure value is most defnitely a string\r\n            if (!value)\r\n                value = '';\r\n            else\r\n                value = JSON.stringify(value);\r\n            // apply encryption if any\r\n            if (_this.encrypt) {\r\n                if (!_this.encrypt.secret || !_this.encrypt.secret.length)\r\n                    throw exceptions_1.default.nullSecretKey;\r\n                value = encrypt_1.applyEncrypt(value, _this.encrypt.secret);\r\n            }\r\n            _this.storage.store(key, value);\r\n        };\r\n        this.get = function (_a) {\r\n            var _b;\r\n            var key = _a.key;\r\n            if (!key || !key.length)\r\n                throw exceptions_1.default.nullKey;\r\n            var value = (_b = _this.storage.get(key)) !== null && _b !== void 0 ? _b : '';\r\n            // apply decryption if any\r\n            if (_this.encrypt) {\r\n                if (!_this.encrypt.secret || !_this.encrypt.secret.length)\r\n                    throw exceptions_1.default.nullSecretKey;\r\n                value = encrypt_1.applyDecrypt(value, _this.encrypt.secret);\r\n            }\r\n            // parse json\r\n            if (value.length) {\r\n                try {\r\n                    value = JSON.parse(value);\r\n                }\r\n                catch (_c) {\r\n                    // parsing from json will fail if\r\n                    // retrieved value is an 8byte (is that what crypto-js said?) encrypted item\r\n                    throw exceptions_1.default.retrievingUndecryptedItem;\r\n                }\r\n            }\r\n            // execute outbound transforms if any\r\n            if (_this.transforms.length) {\r\n                _this.transforms.forEach(function (t) {\r\n                    value = t.outbound(value);\r\n                });\r\n            }\r\n            return value;\r\n        };\r\n        this.eject = function (_a) {\r\n            var key = _a.key;\r\n            if (!key || !key.length)\r\n                throw exceptions_1.default.nullKey;\r\n            _this.storage.eject(key);\r\n        };\r\n        // determine storage engine\r\n        if (props === null || props === void 0 ? void 0 : props.storage) {\r\n            // type check probably not required.\r\n            if (typeof (props === null || props === void 0 ? void 0 : props.storage) == 'object' && 'type' in (props === null || props === void 0 ? void 0 : props.storage)) {\r\n                var selectedEngine = props.storage;\r\n                if (selectedEngine.type == 'indexedDB') {\r\n                    this.storage = storage_1.default[selectedEngine.type](selectedEngine.name);\r\n                }\r\n                else {\r\n                    this.storage = storage_1.default[selectedEngine.type];\r\n                }\r\n            }\r\n            this.storage = (_a = props === null || props === void 0 ? void 0 : props.storage) !== null && _a !== void 0 ? _a : this.defaultStorage;\r\n        }\r\n        else {\r\n            this.storage = this.defaultStorage;\r\n        }\r\n        // assign modifier functions (transforms) if any\r\n        if ((_b = props === null || props === void 0 ? void 0 : props.transforms) === null || _b === void 0 ? void 0 : _b.length) {\r\n            this.transforms = props === null || props === void 0 ? void 0 : props.transforms;\r\n        }\r\n        // bind encrypt\r\n        this.encrypt = props === null || props === void 0 ? void 0 : props.encrypt;\r\n    }\r\n    return Cella;\r\n}());\r\nexports.default = Cella;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar customIndexedDB = function (name) {\r\n    return {\r\n        store: function (key, value) { return localStorage.setItem(key, value); },\r\n        get: function (key) { return localStorage.getItem(key); },\r\n        eject: function (key) { return localStorage.removeItem(key); }\r\n    };\r\n};\r\nexports.default = customIndexedDB;\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar customLocalStorage = {\r\n    store: function (key, value) { return localStorage.setItem(key, value); },\r\n    get: function (key) { return localStorage.getItem(key); },\r\n    eject: function (key) { return localStorage.removeItem(key); }\r\n};\r\nexports.default = customLocalStorage;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar indexedDB_1 = __importDefault(require(\"./indexedDB\"));\r\nvar localStorage_1 = __importDefault(require(\"./localStorage\"));\r\nvar storage = {\r\n    localStorage: localStorage_1.default,\r\n    indexedDB: function (name) { return indexedDB_1.default(name); }\r\n};\r\nexports.default = storage;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__226__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(607);\n"],"sourceRoot":""}